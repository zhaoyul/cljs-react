shadow$provide.module$node_modules$$firebase$messaging$dist$index_cjs=function(global,require,module,exports){function arrayToBase64(array){array=new Uint8Array(array);return btoa(String.fromCharCode.apply(String,tslib.__spread(array))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function base64ToArray(base64String){var padding="\x3d".repeat((4-base64String.length%4)%4);base64String=(base64String+padding).replace(/\-/g,"+").replace(/_/g,"/");base64String=atob(base64String);padding=new Uint8Array(base64String.length);
for(var i=0;i<base64String.length;++i)padding[i]=base64String.charCodeAt(i);return padding}function migrateOldDatabase(senderId){return tslib.__awaiter(this,void 0,void 0,function(){var databases,dbNames,tokenDetails,db$jscomp$0,_this=this;return tslib.__generator(this,function(_a$jscomp$0){switch(_a$jscomp$0.label){case 0:return"databases"in indexedDB?[4,indexedDB.databases()]:[3,2];case 1:databases=_a$jscomp$0.sent();dbNames=databases.map(function(db){return db.name});if(!dbNames.includes("fcm_token_details_db"))return[2,
null];_a$jscomp$0.label=2;case 2:return tokenDetails=null,[4,idb.openDb("fcm_token_details_db",5,function(db){return tslib.__awaiter(_this,void 0,void 0,function(){var objectStore,value,oldDetails,_a;return tslib.__generator(this,function(_b){switch(_b.label){case 0:if(2>db.oldVersion||!db.objectStoreNames.contains("fcm_token_object_Store"))return[2];objectStore=db.transaction.objectStore("fcm_token_object_Store");return[4,objectStore.index("fcmSenderId").get(senderId)];case 1:return value=_b.sent(),
[4,objectStore.clear()];case 2:_b.sent();if(!value)return[2];if(2===db.oldVersion){oldDetails=value;if(!oldDetails.auth||!oldDetails.p256dh||!oldDetails.endpoint)return[2];tokenDetails={token:oldDetails.fcmToken,createTime:null!==(_a=oldDetails.createTime)&&void 0!==_a?_a:Date.now(),subscriptionOptions:{auth:oldDetails.auth,p256dh:oldDetails.p256dh,endpoint:oldDetails.endpoint,swScope:oldDetails.swScope,vapidKey:"string"===typeof oldDetails.vapidKey?oldDetails.vapidKey:arrayToBase64(oldDetails.vapidKey)}}}else 3===
db.oldVersion?(oldDetails=value,tokenDetails={token:oldDetails.fcmToken,createTime:oldDetails.createTime,subscriptionOptions:{auth:arrayToBase64(oldDetails.auth),p256dh:arrayToBase64(oldDetails.p256dh),endpoint:oldDetails.endpoint,swScope:oldDetails.swScope,vapidKey:arrayToBase64(oldDetails.vapidKey)}}):4===db.oldVersion&&(oldDetails=value,tokenDetails={token:oldDetails.fcmToken,createTime:oldDetails.createTime,subscriptionOptions:{auth:arrayToBase64(oldDetails.auth),p256dh:arrayToBase64(oldDetails.p256dh),
endpoint:oldDetails.endpoint,swScope:oldDetails.swScope,vapidKey:arrayToBase64(oldDetails.vapidKey)}});return[2]}})})})];case 3:return db$jscomp$0=_a$jscomp$0.sent(),db$jscomp$0.close(),[4,idb.deleteDb("fcm_token_details_db")];case 4:return _a$jscomp$0.sent(),[4,idb.deleteDb("fcm_vapid_details_db")];case 5:return _a$jscomp$0.sent(),[4,idb.deleteDb("undefined")];case 6:return _a$jscomp$0.sent(),[2,checkTokenDetails(tokenDetails)?tokenDetails:null]}})})}function checkTokenDetails(tokenDetails){if(!tokenDetails||
!tokenDetails.subscriptionOptions)return!1;var subscriptionOptions=tokenDetails.subscriptionOptions;return"number"===typeof tokenDetails.createTime&&0<tokenDetails.createTime&&"string"===typeof tokenDetails.token&&0<tokenDetails.token.length&&"string"===typeof subscriptionOptions.auth&&0<subscriptionOptions.auth.length&&"string"===typeof subscriptionOptions.p256dh&&0<subscriptionOptions.p256dh.length&&"string"===typeof subscriptionOptions.endpoint&&0<subscriptionOptions.endpoint.length&&"string"===
typeof subscriptionOptions.swScope&&0<subscriptionOptions.swScope.length&&"string"===typeof subscriptionOptions.vapidKey&&0<subscriptionOptions.vapidKey.length}function getDbPromise(){dbPromise||(dbPromise=idb.openDb("firebase-messaging-database",1,function(upgradeDb){switch(upgradeDb.oldVersion){case 0:upgradeDb.createObjectStore("firebase-messaging-store")}}));return dbPromise}function dbGet(firebaseDependencies){return tslib.__awaiter(this,void 0,void 0,function(){var key,db,tokenDetails,oldTokenDetails;
return tslib.__generator(this,function(_a){switch(_a.label){case 0:return key=firebaseDependencies.appConfig.appId,[4,getDbPromise()];case 1:return db=_a.sent(),[4,db.transaction("firebase-messaging-store").objectStore("firebase-messaging-store").get(key)];case 2:return(tokenDetails=_a.sent())?[2,tokenDetails]:[3,3];case 3:return[4,migrateOldDatabase(firebaseDependencies.appConfig.senderId)];case 4:return(oldTokenDetails=_a.sent())?[4,dbSet(firebaseDependencies,oldTokenDetails)]:[3,6];case 5:return _a.sent(),
[2,oldTokenDetails];case 6:return[2]}})})}function dbSet(firebaseDependencies,tokenDetails){return tslib.__awaiter(this,void 0,void 0,function(){var key,db,tx;return tslib.__generator(this,function(_a){switch(_a.label){case 0:return key=firebaseDependencies.appConfig.appId,[4,getDbPromise()];case 1:return db=_a.sent(),tx=db.transaction("firebase-messaging-store","readwrite"),[4,tx.objectStore("firebase-messaging-store").put(tokenDetails,key)];case 2:return _a.sent(),[4,tx.complete];case 3:return _a.sent(),
[2,tokenDetails]}})})}function dbRemove(firebaseDependencies){return tslib.__awaiter(this,void 0,void 0,function(){var key,db,tx;return tslib.__generator(this,function(_a){switch(_a.label){case 0:return key=firebaseDependencies.appConfig.appId,[4,getDbPromise()];case 1:return db=_a.sent(),tx=db.transaction("firebase-messaging-store","readwrite"),[4,tx.objectStore("firebase-messaging-store").delete(key)];case 2:return _a.sent(),[4,tx.complete];case 3:return _a.sent(),[2]}})})}function requestGetToken(firebaseDependencies,
subscriptionOptions){return tslib.__awaiter(this,void 0,void 0,function(){var headers,body,subscribeOptions,responseData,response,err_1,message;return tslib.__generator(this,function(_a){switch(_a.label){case 0:return[4,getHeaders(firebaseDependencies)];case 1:headers=_a.sent(),body=getBody(subscriptionOptions),subscribeOptions={method:"POST",headers:headers,body:JSON.stringify(body)},_a.label=2;case 2:return _a.trys.push([2,5,,6]),[4,fetch(getEndpoint(firebaseDependencies.appConfig),subscribeOptions)];
case 3:return response=_a.sent(),[4,response.json()];case 4:return responseData=_a.sent(),[3,6];case 5:throw err_1=_a.sent(),ERROR_FACTORY.create("token-subscribe-failed",{errorInfo:err_1});case 6:if(responseData.error)throw message=responseData.error.message,ERROR_FACTORY.create("token-subscribe-failed",{errorInfo:message});if(!responseData.token)throw ERROR_FACTORY.create("token-subscribe-no-token");return[2,responseData.token]}})})}function requestUpdateToken(firebaseDependencies,tokenDetails){return tslib.__awaiter(this,
void 0,void 0,function(){var headers,body,updateOptions,responseData,response,err_2,message;return tslib.__generator(this,function(_a){switch(_a.label){case 0:return[4,getHeaders(firebaseDependencies)];case 1:headers=_a.sent(),body=getBody(tokenDetails.subscriptionOptions),updateOptions={method:"PATCH",headers:headers,body:JSON.stringify(body)},_a.label=2;case 2:return _a.trys.push([2,5,,6]),[4,fetch(getEndpoint(firebaseDependencies.appConfig)+"/"+tokenDetails.token,updateOptions)];case 3:return response=
_a.sent(),[4,response.json()];case 4:return responseData=_a.sent(),[3,6];case 5:throw err_2=_a.sent(),ERROR_FACTORY.create("token-update-failed",{errorInfo:err_2});case 6:if(responseData.error)throw message=responseData.error.message,ERROR_FACTORY.create("token-update-failed",{errorInfo:message});if(!responseData.token)throw ERROR_FACTORY.create("token-update-no-token");return[2,responseData.token]}})})}function requestDeleteToken(firebaseDependencies,token){return tslib.__awaiter(this,void 0,void 0,
function(){var headers,unsubscribeOptions,response,responseData,message,err_3;return tslib.__generator(this,function(_a){switch(_a.label){case 0:return[4,getHeaders(firebaseDependencies)];case 1:headers=_a.sent(),unsubscribeOptions={method:"DELETE",headers:headers},_a.label=2;case 2:return _a.trys.push([2,5,,6]),[4,fetch(getEndpoint(firebaseDependencies.appConfig)+"/"+token,unsubscribeOptions)];case 3:return response=_a.sent(),[4,response.json()];case 4:responseData=_a.sent();if(responseData.error)throw message=
responseData.error.message,ERROR_FACTORY.create("token-unsubscribe-failed",{errorInfo:message});return[3,6];case 5:throw err_3=_a.sent(),ERROR_FACTORY.create("token-unsubscribe-failed",{errorInfo:err_3});case 6:return[2]}})})}function getEndpoint(_a){return"https://fcmregistrations.googleapis.com/v1/projects/"+_a.projectId+"/registrations"}function getHeaders(_a){var appConfig=_a.appConfig,installations=_a.installations;return tslib.__awaiter(this,void 0,void 0,function(){var authToken;return tslib.__generator(this,
function(_b){switch(_b.label){case 0:return[4,installations.getToken()];case 1:return authToken=_b.sent(),[2,new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":appConfig.apiKey,"x-goog-firebase-installations-auth":"FIS "+authToken})]}})})}function getBody(_a){var vapidKey=_a.vapidKey;_a={web:{endpoint:_a.endpoint,auth:_a.auth,p256dh:_a.p256dh}};"BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4"!==vapidKey&&(_a.web.applicationPubKey=
vapidKey);return _a}function getToken(firebaseDependencies,swRegistration,vapidKey){return tslib.__awaiter(this,void 0,void 0,function(){var pushSubscription,tokenDetails,subscriptionOptions,e_1;return tslib.__generator(this,function(_a){switch(_a.label){case 0:if("granted"!==Notification.permission)throw ERROR_FACTORY.create("permission-blocked");return[4,getPushSubscription(swRegistration,vapidKey)];case 1:return pushSubscription=_a.sent(),[4,dbGet(firebaseDependencies)];case 2:return tokenDetails=
_a.sent(),subscriptionOptions={vapidKey:vapidKey,swScope:swRegistration.scope,endpoint:pushSubscription.endpoint,auth:arrayToBase64(pushSubscription.getKey("auth")),p256dh:arrayToBase64(pushSubscription.getKey("p256dh"))},tokenDetails?[3,3]:[2,getNewToken(firebaseDependencies,subscriptionOptions)];case 3:var dbOptions=tokenDetails.subscriptionOptions,isEndpointEqual=subscriptionOptions.endpoint===dbOptions.endpoint,isAuthEqual=subscriptionOptions.auth===dbOptions.auth,isP256dhEqual=subscriptionOptions.p256dh===
dbOptions.p256dh;if(subscriptionOptions.vapidKey===dbOptions.vapidKey&&isEndpointEqual&&isAuthEqual&&isP256dhEqual)return[3,8];_a.label=4;case 4:return _a.trys.push([4,6,,7]),[4,requestDeleteToken(firebaseDependencies,tokenDetails.token)];case 5:return _a.sent(),[3,7];case 6:return e_1=_a.sent(),console.warn(e_1),[3,7];case 7:return[2,getNewToken(firebaseDependencies,subscriptionOptions)];case 8:return Date.now()>=tokenDetails.createTime+6048E5?[2,updateToken({token:tokenDetails.token,createTime:Date.now(),
subscriptionOptions:subscriptionOptions},firebaseDependencies,swRegistration)]:[2,tokenDetails.token];case 9:return[2]}})})}function deleteToken(firebaseDependencies,swRegistration){return tslib.__awaiter(this,void 0,void 0,function(){var tokenDetails,pushSubscription;return tslib.__generator(this,function(_a){switch(_a.label){case 0:return[4,dbGet(firebaseDependencies)];case 1:return(tokenDetails=_a.sent())?[4,requestDeleteToken(firebaseDependencies,tokenDetails.token)]:[3,4];case 2:return _a.sent(),
[4,dbRemove(firebaseDependencies)];case 3:_a.sent(),_a.label=4;case 4:return[4,swRegistration.pushManager.getSubscription()];case 5:return(pushSubscription=_a.sent())?[2,pushSubscription.unsubscribe()]:[2,!0]}})})}function updateToken(tokenDetails,firebaseDependencies,swRegistration){return tslib.__awaiter(this,void 0,void 0,function(){var updatedToken,updatedTokenDetails,e_2;return tslib.__generator(this,function(_a){switch(_a.label){case 0:return _a.trys.push([0,3,,5]),[4,requestUpdateToken(firebaseDependencies,
tokenDetails)];case 1:return updatedToken=_a.sent(),updatedTokenDetails=tslib.__assign(tslib.__assign({},tokenDetails),{token:updatedToken,createTime:Date.now()}),[4,dbSet(firebaseDependencies,updatedTokenDetails)];case 2:return _a.sent(),[2,updatedToken];case 3:return e_2=_a.sent(),[4,deleteToken(firebaseDependencies,swRegistration)];case 4:throw _a.sent(),e_2;case 5:return[2]}})})}function getNewToken(firebaseDependencies,subscriptionOptions){return tslib.__awaiter(this,void 0,void 0,function(){var token,
tokenDetails;return tslib.__generator(this,function(_a){switch(_a.label){case 0:return[4,requestGetToken(firebaseDependencies,subscriptionOptions)];case 1:return token=_a.sent(),tokenDetails={token:token,createTime:Date.now(),subscriptionOptions:subscriptionOptions},[4,dbSet(firebaseDependencies,tokenDetails)];case 2:return _a.sent(),[2,tokenDetails.token]}})})}function getPushSubscription(swRegistration,vapidKey){return tslib.__awaiter(this,void 0,void 0,function(){var subscription;return tslib.__generator(this,
function(_a){switch(_a.label){case 0:return[4,swRegistration.pushManager.getSubscription()];case 1:return(subscription=_a.sent())?[2,subscription]:[2,swRegistration.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:base64ToArray(vapidKey)})]}})})}function isConsoleMessage(data){return"object"===typeof data&&!!data&&"google.c.a.c_id"in data}function sleep(ms){return new Promise(function(resolve){setTimeout(resolve,ms)})}function getWindowClient(url){return tslib.__awaiter(this,void 0,
void 0,function(){var parsedURL,clientList,clientList_1,clientList_1_1,client,parsedClientUrl,e_1,_a;return tslib.__generator(this,function(_b){switch(_b.label){case 0:return parsedURL=new URL(url,self.location.href),[4,getClientList()];case 1:clientList=_b.sent();try{for(clientList_1=tslib.__values(clientList),clientList_1_1=clientList_1.next();!clientList_1_1.done;clientList_1_1=clientList_1.next())if(client=clientList_1_1.value,parsedClientUrl=new URL(client.url,self.location.href),parsedClientUrl.host===
parsedURL.host)return[2,client]}catch(e_1_1){e_1={error:e_1_1}}finally{try{clientList_1_1&&!clientList_1_1.done&&(_a=clientList_1.return)&&_a.call(clientList_1)}finally{if(e_1)throw e_1.error;}}return[2,null]}})})}function hasVisibleClients(clientList){return clientList.some(function(client){return"visible"===client.visibilityState&&!client.url.startsWith("chrome-extension://")})}function getClientList(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function stripInternalFields(internalPayload){delete internalPayload.messageType;
delete internalPayload.isFirebaseMessaging;return internalPayload}function getMissingValueError(valueName){return ERROR_FACTORY.create("missing-app-config-values",{valueName:valueName})}function isSupported(){return self&&"ServiceWorkerGlobalScope"in self?"indexedDB"in self&&null!==indexedDB&&"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey"):"indexedDB"in window&&null!==indexedDB&&
navigator.cookieEnabled&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}require("module$node_modules$$firebase$installations$dist$index_cjs");global=require("module$node_modules$$firebase$component$dist$index_cjs");module=require("module$node_modules$$firebase$util$dist$index_cjs");var tslib=require("module$node_modules$tslib$tslib"),
idb=require("module$node_modules$idb$build$idb");require=function(ex){return ex&&"object"===typeof ex&&"default"in ex?ex["default"]:ex}(require("module$node_modules$$firebase$app$dist$index_cjs"));var _a$jscomp$1;exports=(_a$jscomp$1={},_a$jscomp$1["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',_a$jscomp$1["only-available-in-window"]="This method is available in a Window context.",_a$jscomp$1["only-available-in-sw"]="This method is available in a service worker context.",
_a$jscomp$1["permission-default"]="The notification permission was not granted and dismissed instead.",_a$jscomp$1["permission-blocked"]="The notification permission was not granted and blocked instead.",_a$jscomp$1["unsupported-browser"]="This browser doesn't support the API's required to use the firebase SDK.",_a$jscomp$1["failed-service-worker-registration"]="We are unable to register the default service worker. {$browserErrorMessage}",_a$jscomp$1["token-subscribe-failed"]="A problem occured while subscribing the user to FCM: {$errorInfo}",
_a$jscomp$1["token-subscribe-no-token"]="FCM returned no token when subscribing the user to push.",_a$jscomp$1["token-unsubscribe-failed"]="A problem occured while unsubscribing the user from FCM: {$errorInfo}",_a$jscomp$1["token-update-failed"]="A problem occured while updating the user from FCM: {$errorInfo}",_a$jscomp$1["token-update-no-token"]="FCM returned no token when updating the user to push.",_a$jscomp$1["use-sw-after-get-token"]="The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",
_a$jscomp$1["invalid-sw-registration"]="The input to useServiceWorker() must be a ServiceWorkerRegistration.",_a$jscomp$1["invalid-bg-handler"]="The input to setBackgroundMessageHandler() must be a function.",_a$jscomp$1["invalid-vapid-key"]="The public VAPID key must be a string.",_a$jscomp$1["use-vapid-key-after-get-token"]="The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used.",_a$jscomp$1);var ERROR_FACTORY=new module.ErrorFactory("messaging",
"Messaging",exports),MessageType;(function(MessageType){MessageType.PUSH_RECEIVED="push-received";MessageType.NOTIFICATION_CLICKED="notification-clicked"})(MessageType||(MessageType={}));var dbPromise=null,SwController=function(){function SwController(firebaseDependencies){var _this=this;this.firebaseDependencies=firebaseDependencies;this.bgMessageHandler=this.vapidKey=this.isOnBackgroundMessageUsed=null;self.addEventListener("push",function(e){e.waitUntil(_this.onPush(e))});self.addEventListener("pushsubscriptionchange",
function(e){e.waitUntil(_this.onSubChange(e))});self.addEventListener("notificationclick",function(e){e.waitUntil(_this.onNotificationClick(e))})}Object.defineProperty(SwController.prototype,"app",{get:function(){return this.firebaseDependencies.app},enumerable:!1,configurable:!0});SwController.prototype.setBackgroundMessageHandler=function(callback){this.isOnBackgroundMessageUsed=!1;if(!callback||"function"!==typeof callback)throw ERROR_FACTORY.create("invalid-bg-handler");this.bgMessageHandler=
callback};SwController.prototype.onBackgroundMessage=function(nextOrObserver){var _this=this;this.isOnBackgroundMessageUsed=!0;this.bgMessageHandler=nextOrObserver;return function(){_this.bgMessageHandler=null}};SwController.prototype.getToken=function(){var _a,_b;return tslib.__awaiter(this,void 0,void 0,function(){var tokenDetails;return tslib.__generator(this,function(_c){switch(_c.label){case 0:return this.vapidKey?[3,2]:[4,dbGet(this.firebaseDependencies)];case 1:tokenDetails=_c.sent(),this.vapidKey=
null!==(_b=null===(_a=null===tokenDetails||void 0===tokenDetails?void 0:tokenDetails.subscriptionOptions)||void 0===_a?void 0:_a.vapidKey)&&void 0!==_b?_b:"BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",_c.label=2;case 2:return[2,getToken(this.firebaseDependencies,self.registration,this.vapidKey)]}})})};SwController.prototype.deleteToken=function(){return deleteToken(this.firebaseDependencies,self.registration)};SwController.prototype.requestPermission=function(){throw ERROR_FACTORY.create("only-available-in-window");
};SwController.prototype.usePublicVapidKey=function(vapidKey){if(null!==this.vapidKey)throw ERROR_FACTORY.create("use-vapid-key-after-get-token");if("string"!==typeof vapidKey||0===vapidKey.length)throw ERROR_FACTORY.create("invalid-vapid-key");this.vapidKey=vapidKey};SwController.prototype.useServiceWorker=function(){throw ERROR_FACTORY.create("only-available-in-window");};SwController.prototype.onMessage=function(){throw ERROR_FACTORY.create("only-available-in-window");};SwController.prototype.onTokenRefresh=
function(){throw ERROR_FACTORY.create("only-available-in-window");};SwController.prototype.onPush=function(event){return tslib.__awaiter(this,void 0,void 0,function(){var internalPayload$jscomp$0,clientList,isNotificationShown,payload;return tslib.__generator(this,function(_a$jscomp$0){switch(_a$jscomp$0.label){case 0:var data=event.data;if(data)try{internalPayload$jscomp$0=data.json()}catch(err){internalPayload$jscomp$0=null}else internalPayload$jscomp$0=null;return internalPayload$jscomp$0?[4,getClientList()]:
(console.debug("FirebaseMessaging: failed to get parsed MessagePayload from the PushEvent. Skip handling the push."),[2]);case 1:clientList=_a$jscomp$0.sent();if(hasVisibleClients(clientList)){data=clientList;var internalPayload=internalPayload$jscomp$0,_a;internalPayload.isFirebaseMessaging=!0;internalPayload.messageType=MessageType.PUSH_RECEIVED;try{for(var clientList_2=tslib.__values(data),clientList_2_1=clientList_2.next();!clientList_2_1.done;clientList_2_1=clientList_2.next())clientList_2_1.value.postMessage(internalPayload)}catch(e_2_1){var e_2=
{error:e_2_1}}finally{try{clientList_2_1&&!clientList_2_1.done&&(_a=clientList_2.return)&&_a.call(clientList_2)}finally{if(e_2)throw e_2.error;}}return[2,void 0]}isNotificationShown=!1;if(!internalPayload$jscomp$0.notification)return[3,3];_a=internalPayload$jscomp$0;e_2=tslib.__assign({},_a.notification);e_2.data=(internalPayload={},internalPayload.FCM_MSG=_a,internalPayload);_a=e_2.actions;clientList_2=Notification.maxActions;_a&&clientList_2&&_a.length>clientList_2&&console.warn("This browser only supports "+
clientList_2+" actions. The remaining actions will not be displayed.");return[4,self.registration.showNotification(null!==(data=e_2.title)&&void 0!==data?data:"",e_2)];case 2:_a$jscomp$0.sent(),isNotificationShown=!0,_a$jscomp$0.label=3;case 3:if(!0===isNotificationShown&&!1===this.isOnBackgroundMessageUsed)return[2];if(this.bgMessageHandler){e_2=internalPayload$jscomp$0;data={from:e_2.from,collapseKey:e_2.collapse_key};if(e_2.notification){data.notification={};if(_a=e_2.notification.title)data.notification.title=
_a;if(_a=e_2.notification.body)data.notification.body=_a;if(_a=e_2.notification.image)data.notification.image=_a}e_2.data&&(data.data=e_2.data);if(e_2.fcmOptions){data.fcmOptions={};if(_a=e_2.fcmOptions.link)data.fcmOptions.link=_a;if(e_2=e_2.fcmOptions.analytics_label)data.fcmOptions.analyticsLabel=e_2}payload=data;"function"===typeof this.bgMessageHandler?this.bgMessageHandler(payload):this.bgMessageHandler.next(payload)}return[2]}})})};SwController.prototype.onSubChange=function(event){var _a,
_b;return tslib.__awaiter(this,void 0,void 0,function(){var newSubscription,tokenDetails;return tslib.__generator(this,function(_c){switch(_c.label){case 0:return(newSubscription=event.newSubscription)?[3,2]:[4,deleteToken(this.firebaseDependencies,self.registration)];case 1:return _c.sent(),[2];case 2:return[4,dbGet(this.firebaseDependencies)];case 3:return tokenDetails=_c.sent(),[4,deleteToken(this.firebaseDependencies,self.registration)];case 4:return _c.sent(),[4,getToken(this.firebaseDependencies,
self.registration,null!==(_b=null===(_a=null===tokenDetails||void 0===tokenDetails?void 0:tokenDetails.subscriptionOptions)||void 0===_a?void 0:_a.vapidKey)&&void 0!==_b?_b:"BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4")];case 5:return _c.sent(),[2]}})})};SwController.prototype.onNotificationClick=function(event){var _a$jscomp$0,_b$jscomp$0;return tslib.__awaiter(this,void 0,void 0,function(){var internalPayload,link,client;return tslib.__generator(this,
function(_c$jscomp$0){switch(_c$jscomp$0.label){case 0:internalPayload=null===(_b$jscomp$0=null===(_a$jscomp$0=event.notification)||void 0===_a$jscomp$0?void 0:_a$jscomp$0.data)||void 0===_b$jscomp$0?void 0:_b$jscomp$0.FCM_MSG;if(!internalPayload||event.action)return[2];event.stopImmediatePropagation();event.notification.close();var _a,_b,_c;link=(_c$jscomp$0=null!==(_b=null===(_a=internalPayload.fcmOptions)||void 0===_a?void 0:_a.link)&&void 0!==_b?_b:null===(_c=internalPayload.notification)||void 0===
_c?void 0:_c.click_action)?_c$jscomp$0:isConsoleMessage(internalPayload.data)?self.location.origin:null;return link?[4,getWindowClient(link)]:[2];case 1:return(client=_c$jscomp$0.sent())?[3,4]:[4,self.clients.openWindow(link)];case 2:return client=_c$jscomp$0.sent(),[4,sleep(3E3)];case 3:return _c$jscomp$0.sent(),[3,6];case 4:return[4,client.focus()];case 5:client=_c$jscomp$0.sent(),_c$jscomp$0.label=6;case 6:if(!client)return[2];internalPayload.messageType=MessageType.NOTIFICATION_CLICKED;internalPayload.isFirebaseMessaging=
!0;return[2,client.postMessage(internalPayload)]}})})};return SwController}(),WindowController=function(){function WindowController(firebaseDependencies){var _this=this;this.firebaseDependencies=firebaseDependencies;this.onMessageCallback=this.vapidKey=null;navigator.serviceWorker.addEventListener("message",function(e){return _this.messageEventListener(e)})}Object.defineProperty(WindowController.prototype,"app",{get:function(){return this.firebaseDependencies.app},enumerable:!1,configurable:!0});
WindowController.prototype.messageEventListener=function(event){return tslib.__awaiter(this,void 0,void 0,function(){var internalPayload,dataPayload;return tslib.__generator(this,function(_a){switch(_a.label){case 0:internalPayload=event.data;if(!internalPayload.isFirebaseMessaging)return[2];if(this.onMessageCallback&&internalPayload.messageType===MessageType.PUSH_RECEIVED)if("function"===typeof this.onMessageCallback)this.onMessageCallback(stripInternalFields(Object.assign({},internalPayload)));
else this.onMessageCallback.next(Object.assign({},internalPayload));dataPayload=internalPayload.data;return isConsoleMessage(dataPayload)&&"1"===dataPayload["google.c.a.e"]?[4,this.logEvent(internalPayload.messageType,dataPayload)]:[3,2];case 1:_a.sent(),_a.label=2;case 2:return[2]}})})};WindowController.prototype.getVapidKey=function(){return this.vapidKey};WindowController.prototype.getSwReg=function(){return this.swRegistration};WindowController.prototype.getToken=function(options){return tslib.__awaiter(this,
void 0,void 0,function(){return tslib.__generator(this,function(_a){switch(_a.label){case 0:return"default"!==Notification.permission?[3,2]:[4,Notification.requestPermission()];case 1:_a.sent(),_a.label=2;case 2:if("granted"!==Notification.permission)throw ERROR_FACTORY.create("permission-blocked");return[4,this.updateVapidKey(null===options||void 0===options?void 0:options.vapidKey)];case 3:return _a.sent(),[4,this.updateSwReg(null===options||void 0===options?void 0:options.serviceWorkerRegistration)];
case 4:return _a.sent(),[2,getToken(this.firebaseDependencies,this.swRegistration,this.vapidKey)]}})})};WindowController.prototype.updateVapidKey=function(vapidKey){return tslib.__awaiter(this,void 0,void 0,function(){return tslib.__generator(this,function(_a){vapidKey?this.vapidKey=vapidKey:this.vapidKey||(this.vapidKey="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4");return[2]})})};WindowController.prototype.updateSwReg=function(swRegistration){return tslib.__awaiter(this,
void 0,void 0,function(){return tslib.__generator(this,function(_a){switch(_a.label){case 0:return swRegistration||this.swRegistration?[3,2]:[4,this.registerDefaultSw()];case 1:_a.sent(),_a.label=2;case 2:if(!swRegistration&&this.swRegistration)return[2];if(!(swRegistration instanceof ServiceWorkerRegistration))throw ERROR_FACTORY.create("invalid-sw-registration");this.swRegistration=swRegistration;return[2]}})})};WindowController.prototype.registerDefaultSw=function(){return tslib.__awaiter(this,
void 0,void 0,function(){var _a,e_1;return tslib.__generator(this,function(_b){switch(_b.label){case 0:return _b.trys.push([0,2,,3]),_a=this,[4,navigator.serviceWorker.register("/firebase-messaging-sw.js",{scope:"/firebase-cloud-messaging-push-scope"})];case 1:return _a.swRegistration=_b.sent(),this.swRegistration.update().catch(function(){}),[3,3];case 2:throw e_1=_b.sent(),ERROR_FACTORY.create("failed-service-worker-registration",{browserErrorMessage:e_1.message});case 3:return[2]}})})};WindowController.prototype.deleteToken=
function(){return tslib.__awaiter(this,void 0,void 0,function(){return tslib.__generator(this,function(_a){switch(_a.label){case 0:return this.swRegistration?[3,2]:[4,this.registerDefaultSw()];case 1:_a.sent(),_a.label=2;case 2:return[2,deleteToken(this.firebaseDependencies,this.swRegistration)]}})})};WindowController.prototype.requestPermission=function(){return tslib.__awaiter(this,void 0,void 0,function(){var permissionResult;return tslib.__generator(this,function(_a){switch(_a.label){case 0:return"granted"===
Notification.permission?[2]:[4,Notification.requestPermission()];case 1:permissionResult=_a.sent();if("granted"===permissionResult)return[2];if("denied"===permissionResult)throw ERROR_FACTORY.create("permission-blocked");throw ERROR_FACTORY.create("permission-default");}})})};WindowController.prototype.usePublicVapidKey=function(vapidKey){if(null!==this.vapidKey)throw ERROR_FACTORY.create("use-vapid-key-after-get-token");if("string"!==typeof vapidKey||0===vapidKey.length)throw ERROR_FACTORY.create("invalid-vapid-key");
this.vapidKey=vapidKey};WindowController.prototype.useServiceWorker=function(swRegistration){if(!(swRegistration instanceof ServiceWorkerRegistration))throw ERROR_FACTORY.create("invalid-sw-registration");if(this.swRegistration)throw ERROR_FACTORY.create("use-sw-after-get-token");this.swRegistration=swRegistration};WindowController.prototype.onMessage=function(nextOrObserver){var _this=this;this.onMessageCallback=nextOrObserver;return function(){_this.onMessageCallback=null}};WindowController.prototype.setBackgroundMessageHandler=
function(){throw ERROR_FACTORY.create("only-available-in-sw");};WindowController.prototype.onBackgroundMessage=function(){throw ERROR_FACTORY.create("only-available-in-sw");};WindowController.prototype.onTokenRefresh=function(){return function(){}};WindowController.prototype.logEvent=function(messageType,data){return tslib.__awaiter(this,void 0,void 0,function(){var eventType,analytics;return tslib.__generator(this,function(_a){switch(_a.label){case 0:a:switch(messageType){case MessageType.NOTIFICATION_CLICKED:eventType=
"notification_open";break a;case MessageType.PUSH_RECEIVED:eventType="notification_foreground";break a;default:throw Error();}return[4,this.firebaseDependencies.analyticsProvider.get()];case 1:return analytics=_a.sent(),analytics.logEvent(eventType,{message_id:data["google.c.a.c_id"],message_name:data["google.c.a.c_l"],message_time:data["google.c.a.ts"],message_device_time:Math.floor(Date.now()/1E3)}),[2]}})})};return WindowController}();_a$jscomp$1={isSupported:isSupported};require.INTERNAL.registerComponent((new global.Component("messaging",
function(container){var app=container.getProvider("app").getImmediate(),_a;if(!app||!app.options)throw getMissingValueError("App Configuration Object");if(!app.name)throw getMissingValueError("App Name");var configKeys=["projectId","apiKey","appId","messagingSenderId"],options=app.options;try{for(var configKeys_1=tslib.__values(configKeys),configKeys_1_1=configKeys_1.next();!configKeys_1_1.done;configKeys_1_1=configKeys_1.next()){var keyName=configKeys_1_1.value;if(!options[keyName])throw getMissingValueError(keyName);
}}catch(e_1_1){var appConfig={error:e_1_1}}finally{try{configKeys_1_1&&!configKeys_1_1.done&&(_a=configKeys_1.return)&&_a.call(configKeys_1)}finally{if(appConfig)throw appConfig.error;}}appConfig={appName:app.name,projectId:options.projectId,apiKey:options.apiKey,appId:options.appId,senderId:options.messagingSenderId};_a=container.getProvider("installations").getImmediate();container=container.getProvider("analytics-internal");app={app:app,appConfig:appConfig,installations:_a,analyticsProvider:container};
if(!isSupported())throw ERROR_FACTORY.create("unsupported-browser");return self&&"ServiceWorkerGlobalScope"in self?new SwController(app):new WindowController(app)},"PUBLIC")).setServiceProps(_a$jscomp$1))}
//# sourceMappingURL=module$node_modules$$firebase$messaging$dist$index_cjs.js.map
